{% extends 'website/base.html' %}
{% load static %}


{% block body %}
    <body class="sub_page">
{% endblock body %}

{% block slide-section %}
    {# DO NOT write anything in this block! #}
{% endblock slide-section %}

{% block content %}
    <h1 style="text-align: center">My Cart</h1>

    {% if unpaid_order_items %}
        <div class="d-flex justify-content-center">
            <div class="  my-4" style="min-height: 50vh">
                <table class="table table-striped ">
                    <thead class="bg-light">
                    <tr>
                        <th>Food name</th>
                        <th>Price</th>
                        <th>Quantity</th>
                        <th>Total</th>
                        <th></th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for order_item in unpaid_order_items %}

                        <tr>
                            <td class="align-middle">
                                <div class="d-flex align-items-center">
                                    {% if order_item.menu_item.image %}
                                        <img
                                                src="{{ order_item.menu_item.image.url }}"
                                                alt=""
                                                style="width: 45px; height: 45px"
                                                class="rounded-circle"
                                        />
                                    {% else %}
                                        <img
                                                src="{% static 'menu/images/default_menu_item_photo.png' %}"
                                                alt=""
                                                style="width: 45px; height: 45px"
                                                class="rounded-circle"
                                        />
                                    {% endif %}
                                    <div class="ms-3">
                                        <p class="m-0 pr-5">{{ order_item.menu_item.food_name }}</p>
                                    </div>
                                </div>
                            </td>
                            <td class="align-middle">
                                <p class="px-2 mb-0 mr-4">${{ order_item.discounted_price }}</p>
                            </td>
                            <td class="align-middle">
                                <form action="{% url 'cart-item-update' order_item.id %}" method="post">
                                    {% csrf_token %}
                                    <div class="d-flex align-items-center mr-5">
                                        <input type="submit" name="+" value="+" class="btn btn-outline-success btn-sm ">
                                        <p class="px-2 m-0">{{ order_item.quantity }}</p>

                                        <input type="submit" name="-" value="-" class="btn btn-outline-danger btn-sm ">
                                    </div>
                                </form>
                            </td>
                            <td class="align-middle">
                                <p class="px-2 m-0">${{ order_item.total_discounted_price }}</p>
                            </td>
                            <td class="align-middle">

                                <!-- delete -->
                                <a href="#"
                                   class="px-2"
                                   title="Delete"
                                   data-bs-toggle="modal"
                                   data-bs-target="#{{ order_item.menu_item.food_name }}"
                                >
                                    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em"
                                         viewBox="0 0 24 24">
                                        <path fill="none" stroke="red" stroke-linecap="round" stroke-linejoin="round"
                                              stroke-width="1.5"
                                              d="m19.5 5.5l-.402 6.506M4.5 5.5l.605 10.025c.154 2.567.232 3.85.874 4.774c.317.456.726.842 1.2 1.131c.671.41 1.502.533 2.821.57m10-7l-7 7m7 0l-7-7M3 5.5h18m-4.944 0l-.683-1.408c-.453-.936-.68-1.403-1.071-1.695a2 2 0 0 0-.275-.172C13.594 2 13.074 2 12.035 2c-1.066 0-1.599 0-2.04.234a2 2 0 0 0-.278.18c-.395.303-.616.788-1.058 1.757L8.053 5.5"
                                              color="currentColor">
                                        </path>
                                    </svg>
                                </a>
                                <!-- delete -->
                                <!-- Modal -->
                                <form action="{% url 'cart-item-delete' order_item.pk %}"
                                      method="post">
                                    {% csrf_token %}
                                    <div class="modal fade" id="{{ order_item.menu_item.food_name }}" tabindex="-1"
                                         aria-labelledby="exampleModalLabel"
                                         aria-hidden="true">
                                        <div class="modal-dialog">
                                            <div class="modal-content">
                                                <div class="modal-header text-dark">
                                                    <h1 class="modal-title fs-5" id="exampleModalLabel">Category
                                                        Deletion</h1>
                                                    <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                            aria-label="Close"></button>
                                                </div>
                                                <div class="modal-body text-dark"
                                                     style="font-family:'Open Sans', sans-serif">
                                                    Are you sure you want to delete
                                                    "<span
                                                        class="text-danger font-weight-bold"> {{ order_item.menu_item.food_name }} </span>"?
                                                </div>
                                                <div class="modal-footer">
                                                    <button type="button" class="btn btn-secondary"
                                                            data-bs-dismiss="modal">
                                                        Cancel
                                                    </button>
                                                    <button type="submit" class="btn btn-danger">Delete</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                                <!-- Modal -->
                            </td>
                        </tr>


                    {% endfor %}
                    <tr class="table-secondary">
                        <td colspan="3">
                            <form class="d-grid gap-2 col-12 mx-auto" action="{% url 'pay-cart' %}" method="post">
                                {% csrf_token %}
                                <button type="submit" class="btn btn-success px-5">Pay</button>
                            </form>
                        </td>
                        <td class="align-middle text-center font-weight-bold text-success pl-0">${{ sum }}</td>
                        <td></td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>


    {% endif %}

{% endblock content %}
